var x=Object.defineProperty;var H=(o,n,i)=>n in o?x(o,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[n]=i;var I=(o,n,i)=>(H(o,typeof n!="symbol"?n+"":n,i),i);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))f(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const m of c.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&f(m)}).observe(document,{childList:!0,subtree:!0});function i(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerpolicy&&(c.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?c.credentials="include":s.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function f(s){if(s.ep)return;s.ep=!0;const c=i(s);fetch(s.href,c)}})();const q="/anime-grid/assets/placeholder-76c5564b.webp",z=[["entry","most_liked","most_rewatched","best_recommendation","best_story"],["best_visuals","best_music","best_voice_acting","most_healing","most_touching"],["most_heart_wrenching","most_underrated","most_overrated","most_ridiculous","most_hated"]],K=["entry","most_liked","most_rewatched","best_recommendation","best_story","best_visuals","best_music","best_voice_acting","most_healing","most_touching","most_heart_wrenching","most_underrated","most_overrated","most_ridiculous","most_hated","most_flop","best_original","best_light_novel_adaptation","best_manga_adaptation","best_movie","most_absurd","most_regretted","most_underrated_gem","best_opening_song","best_ending_song","most_anticipated_sequel","yearn_for_more"],W={table:z,options:K},J=["zh-TW","zh","zh-CN","en","ja"];async function V(){try{let o=navigator.language||navigator.userLanguage;return J.indexOf(o)===-1&&(o="en"),await(await fetch(`./_locale/${o}.json`)).json()}catch(o){console.error(o)}}function X(o){return n=>o[n]||n}const Y="https://imageproxy-rvvouazbtq-de.a.run.app/",G="https://graphql.anilist.co",S="https://zh.wikipedia.org/w/api.php";class Q{constructor(n=null){I(this,"nodeImg");I(this,"nodeDescription");n&&setCellNode(n)}setCellNode(n){this.nodeImg=n.querySelector(".cell-img"),this.nodeDescription=n.querySelector(".cell-description")}editCell(n,i){this.nodeImg.src=n,this.nodeImg.alt=n,this.nodeDescription.innerText=i}}V().then(o=>{const n=X(o);function i(t,e){t.innerText=n(e)}document.querySelectorAll("[data-i18n]").forEach(t=>{const e=t.getAttribute("data-i18n");i(t,e)});const s=document.getElementById("my_table"),c=document.getElementById("add_row_form"),m=document.getElementById("columns_input"),j=document.getElementById("reset_button"),y=document.getElementById("edit_form"),p=document.getElementById("search_work_input"),L=document.getElementById("search_result"),P=document.getElementById("img_file_input"),h=document.getElementById("img_container"),d=document.getElementById("img_preview"),v=document.getElementById("description"),N=document.getElementById("cancel"),_=document.querySelector("dialog"),b=document.getElementById("save_button"),u=new Q;function D(t){var e;return(e=t==null?void 0:t.rows[0])==null?void 0:e.cells.length}function T({numColumns:t,descriptionList:e}){t=(e==null?void 0:e.length)??t??D(s);const a=s.insertRow(-1);for(let r=0;r<t;r++){const l=a.insertCell(r);l.innerHTML=`<div class="cell-wrapper">
           <img class="cell-img" src="data:," alt="data:," />
         <div class="cell-description"></div></div>`,u.setCellNode(l);const g=Array.isArray(e)?e[r]:n("click_to_edit");u.editCell(q,g)}}_.addEventListener("close",()=>{h.innerHTML=""}),y.addEventListener("submit",t=>{t.preventDefault();let e;d.src==="data:,"?e=q:e=d.src,u.editCell(e,v.value),d.src="data:,",d.style.display="none",_.close(),y.reset()}),N.addEventListener("click",()=>_.close());function k(t){const e=new FileReader;e.addEventListener("load",()=>{d.src=e.result,d.style.display="block"}),e.readAsDataURL(t)}P.addEventListener("change",()=>{const t=P.files[0];k(t)}),y.addEventListener("paste",t=>{const e=t.clipboardData??window.clipboardData;if(!e)return;const a=[...e.items].find(r=>r.type.includes("image"));(a==null?void 0:a.kind)==="file"&&k(a.getAsFile())}),s.addEventListener("click",t=>{_.showModal(),u.setCellNode(t.target.closest(".cell-wrapper")),v.value=u.nodeDescription.innerText,p.focus(),C()}),j.addEventListener("click",()=>{m.disabled=!1,s.innerHTML=""}),c.addEventListener("submit",t=>{t.preventDefault(),m.disabled=!0,T({numColumns:m.value})}),b.addEventListener("click",async()=>{i(b,"loading");const t=document.getElementById("table_container_wrapper");try{const e=await html2canvas(t,{useCORS:!0}),a=document.createElement("a");a.download="anime-grid.png",a.href=e.toDataURL(),a.click()}catch(e){console.error(e)}i(b,"save_image")});function R(t,e=300){let a;return(...r)=>{clearTimeout(a),a=setTimeout(()=>{t.apply(this,r)},e)}}async function B(t){t.key==="Enter"&&t.preventDefault(),C()}async function C(){let t=p.value;if(t==="")return;t=await O(t)??t,L.innerHTML=`<div>${n("searching")}</div><div>&nbsp</div>`;const a=await $(t);h.innerHTML="";for(const r of a){const l=document.createElement("img");l.src=r,l.addEventListener("click",()=>{d.src=Y+l.src,d.style.display="block",h.innerHTML=""}),h.appendChild(l)}L.innerHTML=`<span>${n("cant_find_desired_image?")}</span><a href="https://www.google.com/search?tbm=isch&q=${t}" target="_blank">${n("search_in_google_image")}</a><div>${n("paste_here")}</div>`}p.addEventListener("keydown",R(B)),p.addEventListener("input",R(B));async function O(t){try{let e=new URL(S);e.searchParams.set("action","opensearch"),e.searchParams.set("limit","10"),e.searchParams.set("namespace","0"),e.searchParams.set("redirects","resolve"),e.searchParams.set("format","json"),e.searchParams.set("origin","*"),e.searchParams.set("search",t);let a=await fetch(e),r=await a.json();if(!r[1][0]||(t=r[1][0],e=new URL(S),e.searchParams.set("action","query"),e.searchParams.set("lllimit","1"),e.searchParams.set("prop","langlinks"),e.searchParams.set("lllang","ja"),e.searchParams.set("format","json"),e.searchParams.set("origin","*"),e.searchParams.set("titles",t),a=await fetch(e),r=await a.json(),Object.values(r.query.pages).length===0))return;const g=Object.values(r.query.pages)[0].langlinks;return g?g[0]["*"].replace(/\s\(.*\)/,""):void 0}catch(e){console.error(e)}}async function $(t){var w,E;const r=await(await fetch(G,{method:"POST",headers:{"Content-Type":"application/json","Accept-Encoding":"gzip"},body:JSON.stringify({query:`
      query ($page: Int, $perPage: Int, $search: String) {
        Page(page: $page, perPage: $perPage) {
          pageInfo {
            total
            currentPage
            lastPage
            hasNextPage
            perPage
          }
          media(search: $search, sort: FAVOURITES_DESC) {
            title {
              romaji
              english
              native
            }
            coverImage {
              large
            }
          }
        }
      }`,variables:{page:1,perPage:12,search:t}})})).json(),l=(E=(w=r==null?void 0:r.data)==null?void 0:w.Page)==null?void 0:E.media;return(l==null?void 0:l.map(U=>U.coverImage.large))??[]}function A(t){t.table.forEach(e=>{T({descriptionList:e})}),t.options.forEach(e=>{const a=document.createElement("option");a.text=e,a.value=e,v.add(a)})}function F(t){const e={};return e.table=t.table.map(a=>a.map(n)),e.options=t.options.map(n),e}const M=F(W);A(M)});
