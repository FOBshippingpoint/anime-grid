(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();const w=document.getElementById("my_table");let d;function E({numColumns:e,descriptionList:t}){const n=document.getElementById("my_table");t?e=t.length:e||(e=n.rows[0].cells.length);function r(o,c){return parseInt(Math.random()*(c-o)+o)}const i=n.insertRow(-1);for(let o=0;o<e;o++){const c=i.insertCell(o);t?u(c,"https://picsum.photos/"+r(250,300)+"/"+r(400,450),t[o]):u(c,"https://picsum.photos/"+r(250,300)+"/"+r(400,450),"點擊輸入")}}function u(e,t,n){e.innerHTML=`<div class="cell-wrapper"><img src="${t}" alt="${t}" ><div>${n}</div></div>`}const L=document.getElementById("cancel"),h=document.getElementById("img_file_input"),a=document.getElementById("img_preview"),I=document.getElementById("description"),m=document.getElementById("edit_form"),l=document.getElementById("img_container"),p=document.getElementById("search_result"),f=document.getElementById("search_work_input"),y=document.getElementById("edit_dialog");m.addEventListener("submit",function(e){e.preventDefault(),u(d,a.src,I.value),a.src="",y.style.display="none",m.reset(),p.innerHTML=""});L.addEventListener("click",function(){y.style.display="none"});function _(e){const t=new FileReader;t.addEventListener("load",function(){a.src=t.result}),t.readAsDataURL(e)}h.addEventListener("change",function(){const e=h.files[0];_(e)});m.addEventListener("paste",function(e){const n=[...(e.clipboardData||window.clipboardData).items].find(r=>r.type.includes("image"));(n==null?void 0:n.kind)==="file"&&_(n.getAsFile())});w.addEventListener("click",function(e){y.style.display="block",d=e.target.closest("td"),I.value=d.querySelector("div").innerText,f.focus()});const v=document.getElementById("add_row_form"),g=document.getElementById("columns_input"),k=document.getElementById("reset_button");k.addEventListener("click",function(){g.disabled=!1,w.innerHTML=""});v.addEventListener("submit",function(e){e.preventDefault(),g.disabled=!0,E({numColumns:g.value}),v.reset()});const s=document.getElementById("save_button");s.addEventListener("click",async function(){const e=document.getElementById("table_container");s.innerText="載入中...";try{const t=await htmlToImage.toJpeg(e,{quality:.96}),n=document.createElement("a");n.download="output.png",n.href=t,n.click(),s.innerText="儲存"}catch(t){s.innerText="儲存",console.error("oops, something went wrong!",t)}});function T(e){for(const t of e)E({descriptionList:t})}f.addEventListener("keydown",async function(e){if(e.key==="Enter"){e.preventDefault();const t=f.value,n=await B(t);q(n)}});let b;async function B(e){if(e==="")return;e=encodeURIComponent(e);const t=`https://zh.wikipedia.org/w/api.php?action=query&lllimit=500&prop=langlinks&titles=${e}&format=json&origin=*`;try{const n=await fetch(t);b=n;const r=await n.json();if(Object.values(r.query.pages).length===0)return;const i=Object.values(r.query.pages)[0].langlinks;if(i){for(const o of i)if(o.lang==="ja"){let c=o["*"];return c=c.replace(" (漫画)",""),c}}}catch(n){console.log(n)}p.innerHTML=`<a href="https://www.google.com/search?tbm=isch&q=${e.trim()}" target="_blank">在Google圖片搜尋</a><div>右鍵複製圖片後在此貼上</div>`}async function q(e){e=encodeURIComponent(e);const t=`https://api.annict.com/v1/works?access_token=${{}.VITE_ANNICT_API_TOKEN}&fields=images,title,twitter_username&filter_title=${e}`;try{const n=await fetch(t);b=n;const r=await n.json();l.innerHTML="";for(const i of r.works)if(i.images.recommended_url!==""){const o=document.createElement("img");o.src=i.images.recommended_url,o.addEventListener("click",function(){a.src=o.src,l.innerHTML=""}),l.appendChild(o)}p.innerHTML=`<div>找不到結果嗎？試著</div><a href="https://www.google.com/search?tbm=isch&q=${e.trim()}" target="_blank">在Google圖片搜尋</a> or <a href="https://annict.com/search?q=${e.trim()}" target="_blank">在Annict上搜尋</a><div>右鍵複製圖片後在此貼上</div>`}catch(n){console.log(n)}}const M=[["入坑作","最喜歡","看最多次","最想安利","最佳劇情"],["最佳畫面","最佳配樂","最佳配音","最治癒","最感動"],["最虐心","最被低估","最過譽","最離譜","最討厭"]];T(M);
