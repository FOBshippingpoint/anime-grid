(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function o(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerpolicy&&(n.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?n.credentials="include":i.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(i){if(i.ep)return;i.ep=!0;const n=o(i);fetch(i.href,n)}})();const E=document.getElementById("my_table"),y=document.getElementById("add_row_form"),d=document.getElementById("columns_input"),b=document.getElementById("reset_button"),p=document.getElementById("edit_dialog"),u=document.getElementById("edit_form"),m=document.getElementById("search_work_input"),h=document.getElementById("search_result"),v=document.getElementById("img_file_input"),a=document.getElementById("img_container"),s=document.getElementById("img_preview"),I=document.getElementById("description"),L=document.getElementById("cancel"),l=document.getElementById("save_button");let f;function w({numColumns:e,descriptionList:t}){const o=document.getElementById("my_table");t?e=t.length:e||(e=o.rows[0].cells.length);function r(n,c){return parseInt(Math.random()*(c-n)+n)}const i=o.insertRow(-1);for(let n=0;n<e;n++){const c=i.insertCell(n);t?g(c,"https://picsum.photos/"+r(250,300)+"/"+r(400,450),t[n]):g(c,"https://picsum.photos/"+r(250,300)+"/"+r(400,450),"點擊輸入")}}function g(e,t,o){e.innerHTML=`<div class="cell-wrapper"><img src="${t}" alt="${t}" ><div>${o}</div></div>`}u.addEventListener("submit",function(e){e.preventDefault(),g(f,s.src,I.value),s.src="",p.style.display="none",u.reset(),h.innerHTML=""});L.addEventListener("click",function(){p.style.display="none"});function _(e){const t=new FileReader;t.addEventListener("load",function(){s.src=t.result}),t.readAsDataURL(e)}v.addEventListener("change",function(){const e=v.files[0];_(e)});u.addEventListener("paste",function(e){const t=e.clipboardData||window.clipboardData;if(!t)return;const o=[...t.items].find(r=>r.type.includes("image"));(o==null?void 0:o.kind)==="file"&&_(o.getAsFile())});E.addEventListener("click",function(e){p.style.display="block",f=e.target.closest("td"),I.value=f.querySelector("div").innerText,m.focus()});b.addEventListener("click",function(){d.disabled=!1,E.innerHTML=""});y.addEventListener("submit",function(e){e.preventDefault(),d.disabled=!0,w({numColumns:d.value}),y.reset()});l.addEventListener("click",async function(){const e=document.getElementById("table_container");l.innerText="載入中...";try{const t=await htmlToImage.toJpeg(e,{quality:.96}),o=document.createElement("a");o.download="output.png",o.href=t,o.click()}catch(t){console.error(t)}l.innerText="儲存"});function B(e){for(const t of e)w({descriptionList:t})}m.addEventListener("keydown",async function(e){if(e.key==="Enter"){e.preventDefault();const t=m.value,o=await T(t);k(o)}});async function T(e){if(e==="")return;e=encodeURIComponent(e.trim());const t=`https://zh.wikipedia.org/w/api.php?action=query&lllimit=500&prop=langlinks&titles=${e}&format=json&origin=*`;try{const r=await(await fetch(t)).json();if(Object.values(r.query.pages).length===0)return;const i=Object.values(r.query.pages)[0].langlinks;if(i){for(const n of i)if(n.lang==="ja"){let c=n["*"];return c=c.replace(" (漫画)",""),c}}}catch(o){console.error(o)}h.innerHTML=`<a href="https://www.google.com/search?tbm=isch&q=${e}" target="_blank">在Google圖片搜尋</a><div>右鍵複製圖片後在此貼上</div>`}async function k(e){e=encodeURIComponent(e.trim());const t=`https://api.annict.com/v1/works?access_token=${{}.VITE_ANNICT_API_TOKEN}&fields=images,title,twitter_username&filter_title=${e}`;try{const r=await(await fetch(t)).json();a.innerHTML="";for(const i of r.works)if(i.images.recommended_url!==""){const n=document.createElement("img");n.src=i.images.recommended_url,n.addEventListener("click",function(){s.src=n.src,a.innerHTML=""}),a.appendChild(n)}h.innerHTML=`<div>找不到結果嗎？試著</div><a href="https://www.google.com/search?tbm=isch&q=${e}" target="_blank">在Google圖片搜尋</a> or <a href="https://annict.com/search?q=${e}" target="_blank">在Annict上搜尋</a><div>右鍵複製圖片後在此貼上</div>`}catch(o){console.log(o)}}const q=[["入坑作","最喜歡","看最多次","最想安利","最佳劇情"],["最佳畫面","最佳配樂","最佳配音","最治癒","最感動"],["最虐心","最被低估","最過譽","最離譜","最討厭"]];B(q);
